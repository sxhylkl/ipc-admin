/** * Created by zzq on 2017/4/18. */define(function (require){    //加载所需模块    var app = require('app');    require('myService');    require('load');    loadCss = require('loadCss');    loadCss.loadCss('res/css/pList.css')//引入css        app.controller('pListController', function ($scope,myService)    {                //初始化查询条件        $scope.dateOption = {            pType: '',            pId: '',            pInfo: '',            startPage: '1',//索要的页码            pageSize: '2',//每页显示数量            startTime: '',            endTime: ''        };        console.log($scope.dateOption.startTime);                //日期插件配置及操作        //时间选择器配置        $scope.startDateOptions = {            formatYear: 'yy',            maxDate: new Date(),//设置最大时间不可超过当前时间            startingDay: 1        };        $scope.endDateOptions = {            formatYear: 'yy',            maxDate: new Date(),            startingDay: 1        };            //当有一个时间改变时，重置另一个的时间范围        $scope.updateMin = function(){            $scope.endDateOptions.minDate = $scope.dateOption.startTime;            //当开始时间改变时，设置pageInfo.startTime            $scope.pageInfo.startTime = isNaN(new Date($scope.dateOption.startTime).getTime())?'':new Date($scope.dateOption.startTime).getTime();        };        $scope.updateMax = function(){            $scope.startDateOptions.maxDate = $scope.dateOption.endTime;            //当结束时间改变时，设置pageInfo.endTime            $scope.pageInfo.endTime = isNaN(new Date($scope.dateOption.endTime).getTime())?'':new Date($scope.dateOption.endTime).getTime();        };            //时间面板展开隐藏设置        $scope.startOpen = function() {            $scope.startPopupOpened = true;        };        $scope.endOpen = function() {            $scope.endPopupOpened = true;        };        $scope.startPopupOpened = false;        $scope.endPopupOpened = false;            //初始化向后台请求数据时携带的参数        $scope.pageInfo = {            devType:'',//设备型号            p2pId:'',//设备编号            firmware:'',//固件版本号            startTime:'',            endTime:'',            startPage:1,      //索要的页码            pageSize:10     //每页条数        };                //数据url        // var url = 'res/json/pList.json';        var url = 'kinzo-cms/device/ipcs';            //定义请求某页数据的函数，传入请求地址和请求参数        var showIpcList = function(url,requestData,method){            // requestData = $scope.pageInfo;                    myService.getJson(url,requestData,method)            //请求成功时的回调函数，将获取的数据进行处理                .success(function(data){                    load.close();                    $scope.ipcInfoList = data.ipcInfoList;//将获取到的列表数据存入scope                    console.log(data.ipcInfoList)                    $scope.totalCount = data.totalCount;//将总条目数存入scope                    $scope.maxSize = 5;//设置显示的页码数量                    $scope.startPage = $scope.pageInfo.startPage;//设置当前页码                })        };                //进入router默认显示所有数据        showIpcList(url,$scope.pageInfo);                //点击页码时将索要的页码存入ajax请求参数内        $scope.pageChange = function(){            console.log($scope.startPage);            $scope.pageInfo.startPage = $scope.startPage;            // showIpcList(url,$scope.pageInfo);//携带新参数重新请求，本地测试            showIpcList(url,$scope.pageInfo);//携带新参数重新请求，联测        };                        //条件查询        $scope.goSearch = function(){            $scope.pageInfo.startPage = 1;//页码初始化为1            console.log($scope.pageInfo);            //开始查询            // showIpcList(url,$scope.pageInfo);//发起请求，本地测试            showIpcList(url,$scope.pageInfo);//发起请求，联测        }    });})