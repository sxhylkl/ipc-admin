/** * Created by zzq on 2017/5/3. */define(['app', 'loadCss', 'myService', 'dashBoard'], function (app, loadCss) {    //引入css    loadCss.loadCss('res/lib/zui/css/zui.min.css');    loadCss.loadCss('res/lib/zui/dashboard/zui.dashboard.min.css');    loadCss.loadCss('res/css/home.css');    app.controller('homeController', function ($scope, myService, $timeout, data) {        console.log(data);        //ajax获取控制面板当前布局currentLayout        $scope.currentlayOut = [            {id: "userList", title:'用户列表', order: '1', colWidth: '8', height:"300px" , "sref": "userList",},            {id: "userInfo", title:"用户列表",order: '2', colWidth: '2',  height:"400px", "sref": "userInfo",},            {id: "productList", title:"用户列表",order: '3', colWidth: '4',  height:"500px", "sref": "ipcList",}        ];        //新增面板        $scope.newModule = {            colWidth:'',            title:'',            id:'',            colWidth: '8',            height: 300,            sref:''        }        $scope.showModel = false;        $scope.addPanel = function(){            $scope.showModel = true;        };        $scope.ensure = function(){            console.log($scope.newModule)            //这里直接在页面内添加ng和zui会冲突，所以选择，先把数据提交到后台，再重新渲染整个页面            $scope.currentlayOut.push($scope.newModule);            $scope.showModel = false;        };        $scope.exit = function(){            $scope.showModel = false;        }    })    //定义repeatFinish指令监测ng-repeat是否执行完成    app.directive('repeatFinish', function () {        return {            link: function (scope, element, attr) {                console.log(scope.$index)                if (scope.$last == true) {                    //当repeat执行完之后再实例化dashboard                    panelRender(scope);                }            }        }    });    //panel配置    function panelRender(scope) {        $('#dashboard').dashboard({            draggable: true,//是否可以拖拽            height: '300px',//全部面板默认高度            sensitive: false,//灵敏度判断            resizable: true,//是否允许拖拽改变尺寸            resizeMessage: true,//tips预览当前尺寸            afterPanelRemoved: function (id) {//面板移除后的回调函数                console.log('面板移除' + id);            },            panelRemovingTip: '{0}aaa',//移除面板前的确认消息{0}为面板名称            afterOrdered: function (newOrders) {//重新排序后的回调函数                console.log(newOrders)            },            afterRefresh: function () {//远程加载完成后的回调函数                console.log('远程加载完成')            },            onResize: function (e) {                console.log(e)            }        });    }})